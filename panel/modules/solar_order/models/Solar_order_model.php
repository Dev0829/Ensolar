<?phpdefined('BASEPATH') or exit('No direct script access allowed');class Solar_order_model extends App_Model{    protected $_table_name = S_MODULE_DB_TABLE;    protected $_primary_key = 'id';    protected $_primary_filter = 'intval';    function __construct()    {        parent::__construct();    }    // Get Last id saved    public function getLastID(){        return $this->db->select('id')->order_by('id',"desc")->limit(1)->get($this->_table_name)->row();    }    public function get($id = NULL, $single = FALSE){        if ($id != NULL) {            $filter = $this->_primary_filter;            $id = $filter($id);            $this->db->where($this->_primary_key, $id);            $method = 'row_array';        } elseif($single == TRUE) {            $method = 'row_array';        } else {            $method = 'result_array';        }        return $this->db->get($this->_table_name)->$method();    }    public function get_by($where, $single = FALSE){        $this->db->where($where);        return $this->get(NULL, $single);    }    public function save($data, $id = NULL){        $now = date('Y-m-d H:i:s');        $data['date_of_sale'] = isset($data['date_of_sale']) ? to_sql_date($data['date_of_sale']) : NULL;        // Insert        if ($id === NULL) {            !isset($data[$this->_primary_key]) || $data[$this->_primary_key] = NULL;           /* if (isset($data['created_type']) && $data['created_type'] = 'client'){                $data['created_type'] = 'client';                $data['client_created_by'] = get_contact_user_id();            } else {                $data['created_type'] = 'staff';                $data['created_by'] = get_staff_user_id();            }*/            $data['created'] = $now;            $this->db->set($data);            $this->db->insert($this->_table_name);            $id = $this->db->insert_id();        } else {            $filter = $this->_primary_filter;            $data['modified_at'] = $now;            $id = $filter($id);            $data = array_filter($data);            $this->db->set($data);            $this->db->where($this->_primary_key, $id);            $this->db->update($this->_table_name);        }        return $id;    }}